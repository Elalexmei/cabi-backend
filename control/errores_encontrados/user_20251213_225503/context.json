[
  {
    "timestamp": "2025-12-13T22:55:03.353479",
    "component": "suppressed_output",
    "level": "suppressed_component",
    "session_id": "user_20251213_225503",
    "operation": "tableanalyzer_init",
    "suppressed_data": {
      "session_id": "user_20251213_225503",
      "timestamp": "2025-12-13T22:55:03.353467",
      "operation_name": "tableanalyzer_init",
      "stdout_content": "ğŸ¯ INICIALIZANDO ANALIZADOR COMPATIBLE CON PALABRAS ANCLA\n======================================================================\nğŸ“ CARGANDO DICCIONARIOS CON PALABRAS ANCLA\nğŸ“‚ Ruta: /Users/apple/Desktop/UVM/parcial_8/BB/soluciones_prog_mov/A8_AMI/proyecto_CABI/cabi_0.0.5/diccionarios/complejos\n============================================================\nâœ… Estructura JSON de palabras ancla verificada\n   âœ… anchors/dimension_anchors.json\n   ğŸ”¥ Expandido: 19 anclas â†’ 532 dimensiones\n   âœ… anchors/metric_anchors.json\n   ğŸ”¥ Expandido: 20 anclas â†’ 490 mÃ©tricas\n   âœ… core/operations.json\n   âœ… core/known_columns.json\n   âœ… core/common_values.json\n   âš ï¸ No encontrado: linguistic/connectors.json\n   âš ï¸ No encontrado: linguistic/word_numbers.json\n   âš ï¸ No encontrado: linguistic/typo_corrections.json\n   âœ… temporal/temporal_indicators.json\n   âœ… temporal/temporal_units.json\n\nğŸ“Š RESULTADO DE CARGA CON PALABRAS ANCLA:\n   âœ… Archivos bÃ¡sicos cargados: 3/3\n   ğŸ“‚ Dimensiones (expandidas): 532\n   ğŸ“Š MÃ©tricas (expandidas): 490\n   âš¡ Operaciones: 57\n   ğŸ“ Anclas de dimensiÃ³n: 19\n   ğŸ“ Anclas de mÃ©trica: 20\n   ğŸ• Cargado: 2025-12-13 22:55:03\nâœ… Diccionarios con palabras ancla cargados exitosamente\nğŸ”¥ TODAS LAS VARIACIONES DISPONIBLES: 1022 tÃ©rminos\nâœ… Estructura JSON de palabras ancla verificada\nâœ… Diccionarios con palabras ancla cargados:\nğŸ“ Ruta: /Users/apple/Desktop/UVM/parcial_8/BB/soluciones_prog_mov/A8_AMI/proyecto_CABI/cabi_0.0.5/diccionarios/complejos\nğŸ• Ãšltima carga: 2025-12-13T22:55:03.324685\nâœ… Carga exitosa: True\nğŸ”¥ Sistema de anclas: True\nğŸ“Š EstadÃ­sticas cargadas:\n   ğŸ“‚ Dimensiones (expandidas): 532\n   ğŸ“Š MÃ©tricas (expandidas): 490\n   âš¡ Operaciones: 57\n   ğŸ“ Anclas de dimensiÃ³n: 19\n   ğŸ“ Anclas de mÃ©trica: 20\n\nğŸ”¥ EJEMPLO DE EXPANSIONES CARGADAS:\n   ğŸ“‚ 'employee': 48 variaciones â†’ ['vendedor', 'vendedores', 'empleado', 'empleados', 'personal']...\n   ğŸ“‚ 'category': 34 variaciones â†’ ['categoria', 'categorias', 'categorÃ­a', 'categorÃ­as', 'cat']...\nğŸ“ Directorios temporales verificados\nğŸ”¥ Analizador compatible con palabras ancla listo\nâœ… MySQL disponible: localhost/datos_imperiales\nğŸ”¥ Analizador con opciÃ³n MySQL listo\nâœ… ClickHouse disponible: localhost/datos_imperiales\nğŸ”¥ Analizador con opciones MySQL + ClickHouse listo",
      "stderr_content": "",
      "has_content": true
    }
  },
  {
    "timestamp": "2025-12-13T22:55:03.358060",
    "component": "suppressed_output",
    "level": "suppressed_component",
    "session_id": "user_20251213_225503",
    "operation": "problemizador_init",
    "suppressed_data": {
      "session_id": "user_20251213_225503",
      "timestamp": "2025-12-13T22:55:03.358056",
      "operation_name": "problemizador_init",
      "stdout_content": "âœ… Operaciones cargadas: 161 palabras ancla\n   ğŸ‡ªğŸ‡¸ Aliases configurados para ESPAÃ‘OL\n   âœ… Conectores activos: 30 palabras\n   âœ… NÃºmeros activos: 31 palabras\n   âœ… Correcciones activas: 20 palabras\nâœ… Diccionario temporal cargado: 387 entradas\nâœ… Diccionarios JSON cargados exitosamente\nğŸ”§ Construyendo Ã­ndices de bÃºsqueda optimizada...\nâœ… Ãndice temporal: 387 entradas\nâœ… Frases compuestas en cache: 211 entradas\nâœ… Ãndices construidos: 1011 palabras en 0.000s\nğŸ“‹ Log de palabras desconocidas cargado: 3 consultas previas\nğŸš€ Parser NLP Unificado iniciado\nğŸ“š Diccionarios cargados: {'total_dimensiones': 392, 'total_operaciones': 161, 'total_metricas': 384, 'source': 'JSON files'}\nğŸš¨ Sistema de palabras desconocidas activado\nğŸ“ Log de palabras desconocidas: control/consultas_sin_respuestas/unknown_words_log.json",
      "stderr_content": "",
      "has_content": true
    }
  },
  {
    "timestamp": "2025-12-13T22:55:03.358533",
    "component": "suppressed_output",
    "level": "suppressed_component",
    "session_id": "user_20251213_225503",
    "operation": "sql_mapper_init",
    "suppressed_data": {
      "session_id": "user_20251213_225503",
      "timestamp": "2025-12-13T22:55:03.358530",
      "operation_name": "sql_mapper_init",
      "stdout_content": "âœ… Cargado dimension_anchors.json: 19 entradas\nâœ… Cargado metric_anchors.json: 20 entradas\nğŸ”„ Mapeo reverso construido: 997 palabras mapeadas\nğŸ”— SQLSchemaMapper inicializado:\n   ğŸ“ Dimensiones: 19 anchors\n   ğŸ“Š MÃ©tricas: 20 anchors\n   ğŸ”„ Mapeos reversos: 997 palabras",
      "stderr_content": "",
      "has_content": true
    }
  },
  {
    "timestamp": "2025-12-13T22:55:12.769994",
    "component": "suppressed_output",
    "level": "suppressed_component",
    "session_id": "user_20251213_225503",
    "operation": "problemizador_process",
    "suppressed_data": {
      "session_id": "user_20251213_225503",
      "timestamp": "2025-12-13T22:55:12.769929",
      "operation_name": "problemizador_process",
      "stdout_content": "ğŸ” ANALIZANDO CONSULTA: 'LIST FIRST 10 ROWS'\nğŸ” DETECTANDO FRASES COMPUESTAS (Dictionary-Based): 'LIST FIRST 10 ROWS'\nğŸ” DEBUG: Query con placeholders: 'LIST FIRST 10 ROWS'\nğŸ” DEBUG: Text en minÃºsculas: 'list first 10 rows'\n   ğŸ” Generadas 211 frases compuestas automÃ¡ticamente\nğŸ” DEBUG: Antes de restaurar mayÃºsculas: 'list first 10 rows'\nğŸ”“ RESTAURANDO TOKENS:\n   ğŸ“¥ Input: 'list first 10 rows'\n   ğŸ”‘ Tokens preservados: {}\n   ğŸ“¤ Output: 'list first 10 rows'\nğŸ” DEBUG: DespuÃ©s de restaurar mayÃºsculas: 'list first 10 rows'\nğŸ” TOKENS ORIGINALES: ['list', 'first', '10', 'rows']\nğŸ”’ DATOS EXCLUIDOS: [] (letras mayÃºsculas = DATOS)\nğŸ” TOKENS PARA ANÃLISIS: ['list', 'first', '10', 'rows']\n   ğŸ‡ºğŸ‡¸ Conector inglÃ©s: 'rows' (+10)\n   ğŸ¯ RESULTADO: INGLÃ‰S (score: 10 vs 0)\n   ğŸ‡ºğŸ‡¸ Aliases configurados para INGLÃ‰S\n   âœ… Conectores activos: 134 palabras\n   âœ… NÃºmeros activos: 43 palabras\n   âœ… Correcciones activas: 76 palabras\nğŸŒ IDIOMA DETECTADO: EN\nğŸ‡ºğŸ‡¸ CONSULTA EN INGLÃ‰S DETECTADA - ENVIANDO A PIPELINE INGLÃ‰S\nâœ… Cargado dimension_anchors.json: 19 entradas\nâœ… Cargado metric_anchors.json: 20 entradas\nğŸ”„ Mapeo reverso construido: 997 palabras mapeadas\nğŸ”— SQLSchemaMapper inicializado:\n   ğŸ“ Dimensiones: 19 anchors\n   ğŸ“Š MÃ©tricas: 20 anchors\n   ğŸ”„ Mapeos reversos: 997 palabras\nğŸ‡ºğŸ‡¸ English NLP Parser initialized with SQL Schema Mapper\n\nğŸ‡ºğŸ‡¸ PROCESSING ENGLISH QUERY: 'LIST FIRST 10 ROWS'\nğŸ”§ Normalizing English query: 'list first 10 rows'\nâœ… English normalized: 'list first 10 rows'\nğŸ§ª DEBUGGING TEMPORAL DICTIONARY:\n   âŒ 'palacio de hierro' â†’ NOT FOUND\n   âŒ 'palaciodehierro' â†’ NOT FOUND\n   âŒ 'palacio_de_hierro' â†’ NOT FOUND\n   âŒ 'liverpool' â†’ NOT FOUND\nğŸ”¤ English tokens: ['list', 'first', '10', 'rows']\nğŸ” ANÃLISIS PRE-MAPEO de tokens originales: ['list', 'first', '10', 'rows']\n   ğŸ“Š PLURAL ORIGINAL detectado: 'rows' â†’ SUM\nğŸ§  English semantic intent: SUM\nâ° DETECTING ENGLISH TEMPORAL PATTERNS:\n   ğŸ”¤ Full tokens list: ['list', 'first', '10', 'rows']\n   ğŸ“ Total tokens: 4\n   ğŸ” 'between' found at positions: []\nâ° TOTAL ENGLISH TEMPORAL FILTERS: 0\nğŸ¯ DETECTING ENGLISH COLUMN-VALUE PATTERNS (WITH ENHANCED STOCK OUT - ORIGINAL METHOD):\nğŸ“… DETECTING THIS WEEK PATTERN:\n   ğŸ“¤ Tokens: ['list', 'first', '10', 'rows']\n   âŒ No 'this week' pattern found\n   ğŸ”§ DEBUG: Llamando a detect_enhanced_stock_out_pattern_english...\nğŸ“¦ DETECTING ENHANCED Y/N COLUMN PATTERN:\n   ğŸ“¤ Tokens: ['list', 'first', '10', 'rows']\n   âŒ No Y/N column pattern found\n      ğŸ” Testing combination: ['list', 'first', '10', 'rows'] (positions 0-3)\n         ğŸ” Testing variant: 'list first 10 rows'\n         ğŸ” Testing variant: 'LIST FIRST 10 ROWS'\n         ğŸ” Testing variant: 'listfirst10rows'\n         ğŸ” Testing variant: 'list(first(10(rows'\n         ğŸ” Testing variant: 'LISTFIRST10ROWS'\n         ğŸ” Testing variant: 'list_first_10_rows'\n         ğŸ” Testing variant: 'LIST_FIRST_10_ROWS'\n         ğŸ” Testing variant: 'List First 10 Rows'\n      ğŸ” Testing combination: ['list', 'first', '10'] (positions 0-2)\n         ğŸ” Testing variant: 'list first 10'\n         ğŸ” Testing variant: 'LIST FIRST 10'\n         ğŸ” Testing variant: 'listfirst10'\n         ğŸ” Testing variant: 'list(first(10'\n         ğŸ” Testing variant: 'LISTFIRST10'\n         ğŸ” Testing variant: 'list_first_10'\n         ğŸ” Testing variant: 'LIST_FIRST_10'\n         ğŸ” Testing variant: 'List First 10'\n      ğŸ” Testing combination: ['list', 'first'] (positions 0-1)\n         ğŸ” Testing variant: 'list first'\n         ğŸ” Testing variant: 'LIST FIRST'\n         ğŸ” Testing variant: 'listfirst'\n         ğŸ” Testing variant: 'list(first'\n         ğŸ” Testing variant: 'LISTFIRST'\n         ğŸ” Testing variant: 'list_first'\n         ğŸ” Testing variant: 'LIST_FIRST'\n         ğŸ” Testing variant: 'List First'\n      ğŸ” Testing combination: ['list'] (positions 0-0)\n         ğŸ” Testing variant: 'list'\n         ğŸ” Testing variant: 'LIST'\n         ğŸ” Testing variant: 'List'\n      ğŸ” Testing combination: ['first', '10', 'rows'] (positions 1-3)\n         ğŸ” Testing variant: 'first 10 rows'\n         ğŸ” Testing variant: 'FIRST 10 ROWS'\n         ğŸ” Testing variant: 'first10rows'\n         ğŸ” Testing variant: 'first(10(rows'\n         ğŸ” Testing variant: 'FIRST10ROWS'\n         ğŸ” Testing variant: 'first_10_rows'\n         ğŸ” Testing variant: 'FIRST_10_ROWS'\n         ğŸ” Testing variant: 'First 10 Rows'\n      ğŸ” Testing combination: ['first', '10'] (positions 1-2)\n         ğŸ” Testing variant: 'first 10'\n         ğŸ” Testing variant: 'FIRST 10'\n         ğŸ” Testing variant: 'first10'\n         ğŸ” Testing variant: 'first(10'\n         ğŸ” Testing variant: 'FIRST10'\n         ğŸ” Testing variant: 'first_10'\n         ğŸ” Testing variant: 'FIRST_10'\n         ğŸ” Testing variant: 'First 10'\n      ğŸ” Testing combination: ['first'] (positions 1-1)\n         ğŸ” Testing variant: 'first'\n         ğŸ” Testing variant: 'FIRST'\n         ğŸ” Testing variant: 'First'\n      ğŸ” Testing combination: ['10', 'rows'] (positions 2-3)\n         ğŸ” Testing variant: '10 rows'\n         ğŸ” Testing variant: '10 ROWS'\n         ğŸ” Testing variant: '10rows'\n         ğŸ” Testing variant: '10(rows'\n         ğŸ” Testing variant: '10ROWS'\n         ğŸ” Testing variant: '10_rows'\n         ğŸ” Testing variant: '10_ROWS'\n         ğŸ” Testing variant: '10 Rows'\n      ğŸ” Testing combination: ['10'] (positions 2-2)\n         ğŸ” Testing variant: '10'\n      ğŸ” Testing combination: ['rows'] (positions 3-3)\n         ğŸ” Testing variant: 'rows'\n         ğŸ” Testing variant: 'ROWS'\n         ğŸ” Testing variant: 'Rows'\nğŸ” TOTAL IMPLICIT VALUES DETECTED: 0\nğŸ”’ TOTAL POSITIONS PROCESSED: []\nâ° Temporal columns to exclude: set()\nğŸ”’ Positions already processed: []\nğŸ¯ Total filters detected: 0\n   ğŸ“¦ Enhanced stock out: 0\n   ğŸ” Implicit: 0\n   ğŸ” Explicit: 0\nğŸ”’ Final processed positions: []\nğŸ”§ REMOVING DUPLICATE FILTERS:\nğŸ¯ Final unique filters: 0\nğŸ• DETECTING TEMPORAL CONDITIONAL PATTERN:\n   ğŸ“¤ Tokens: ['list', 'first', '10', 'rows']\nğŸ• DEBUG: temporal_conditional_pattern = False\nğŸ“‹ DETECTING LIST ALL PATTERN:\n   ğŸ”¤ Tokens: ['list', 'first', '10', 'rows']\n   âœ… List indicator: 'list' at position 0\n   âŒ No target dimension found\nğŸ“‹ DEBUG: list_all_pattern = False\nğŸ“Š DETECTING SHOW ROWS PATTERN:\n   ğŸ”¤ Tokens: ['list', 'first', '10', 'rows']\n   âœ… Show indicator: 'list' at position 0\n   âœ… Position indicator: 'first' at position 1\n   âœ… Row count (number): 10\n   âœ… Object type: 'rows'\nğŸ“Š SHOW ROWS PATTERN DETECTED:\n   ğŸ“Š Show indicator: list\n   ğŸ“ Position: first\n   ğŸ”¢ Row count: 10\n   ğŸ“‹ Object type: rows\n   â­ Confidence: 1.00\nğŸ“Š DEBUG: show_rows_pattern = True\nğŸ” CLASSIFYING ENGLISH COMPONENTS:\nğŸ” English token 'list' classified as unknown\nğŸ” English token 'first' classified as operation\nğŸ” English token '10' classified as value\nğŸ” English token 'rows' classified as connector\nğŸ—ï¸ BUILDING COMPLETE ENGLISH QUERY STRUCTURE\nğŸ” DETECTING GROUP BY PATTERN:\nğŸ“Š DETECTING SHOW ROWS PATTERN:\n   ğŸ”¤ Tokens: ['list', 'first', '10', 'rows']\n   âœ… Show indicator: 'list' at position 0\n   âœ… Position indicator: 'first' at position 1\n   âœ… Row count (number): 10\n   âœ… Object type: 'rows'\nğŸ“Š SHOW ROWS PATTERN DETECTED:\n   ğŸ“Š Show indicator: list\n   ğŸ“ Position: first\n   ğŸ”¢ Row count: 10\n   ğŸ“‹ Object type: rows\n   â­ Confidence: 1.00\n   ğŸ“Š Show rows pattern detected: True\nğŸ“‹ DETECTING LIST ALL PATTERN:\n   ğŸ”¤ Tokens: ['list', 'first', '10', 'rows']\n   âœ… List indicator: 'list' at position 0\n   âŒ No target dimension found\n   ğŸ“‹ List all pattern detected: False\nğŸ• DETECTING TEMPORAL CONDITIONAL PATTERN:\n   ğŸ“¤ Tokens: ['list', 'first', '10', 'rows']\n   ğŸ• Temporal conditional pattern detected: False\n   ğŸ† Skipping ranking detection due to special patterns\nğŸš« DETECTING ENGLISH EXCLUSION FILTERS:\nğŸš« TOTAL ENGLISH EXCLUSION FILTERS: 0\nğŸ”— DETECTING ENGLISH MULTIPLE DIMENSIONS:\n   ğŸ“ English dimensions found: []\n   ğŸ”— English connectors at positions: []\n   âŒ No valid English multi-dimensional pattern detected\nğŸ”— DETECTING ENGLISH COMPOUND CRITERIA:\n   ğŸ”¤ Tokens: ['list', 'first', '10', 'rows']\n   ğŸ“Š Segments detected: [['list', 'first', '10', 'rows']]\n\n   ğŸ¯ Processing English segment 1: ['list', 'first', '10', 'rows']\n      ğŸ” Analyzing English segment: ['list', 'first', '10', 'rows']\n         âš¡ English operation found: first\n         âŒ English criteria incomplete:\n             Operation: first\n             Metric: NOT FOUND\n      âŒ Could not extract criteria from segment\n\nğŸ”— TOTAL ENGLISH COMPOUND CRITERIA: 0\nğŸ”— EVALUATING ENGLISH COMPOUND QUERY:\n   ğŸ“Š Valid criteria: 0\n   ğŸ¯ Is compound: False\n   âš¡ English operation: first\n   ğŸ“Š Structure marked as SHOW_ROWS (overriding ranking)\nğŸ” DETECTING ENGLISH QUERY PATTERN:\n   ğŸ“ Dimension: N/A\n   ğŸ”— Multiple dimensions: 0\n   âš¡ Operations: ['first']\n   ğŸ“Š Metrics: []\n   ğŸ† Is ranking: False\n   ğŸ”— Is compound: False\n   ğŸ“ Is multi-dimensional: False\n   ğŸ“Š ENGLISH PATTERN: SHOW_ROWS (special pattern priority)\nğŸ”¢ DETECTING COUNT PATTERNS IN: 'list first 10 rows'\n   âŒ No COUNT pattern detected\nğŸ—ï¸ English structure built successfully:\n   ğŸ“Š Operations: 1\n   ğŸ“ˆ Metrics: 0\n   ğŸ¯ Query pattern: show_rows\n   ğŸ† Is ranking: False\n   ğŸ”— Is compound: False\n   ğŸ”— Is multi-dimensional: False\n   ğŸ• Has temporal conditional: False\n   ğŸ“‹ Has list all: False\n   ğŸ“Š Has show rows: True\nğŸ”§ DEBUG: Llegando a validaciÃ³n...\nğŸ” VALIDATING ENGLISH STRUCTURE:\n   ğŸ“‹ Has list_all_pattern: False\n   ğŸ“Š SHOW_ROWS pattern detected - using special validation\n   âœ… SHOW_ROWS validation passed - count: 10\nğŸ”§ DEBUG: ValidaciÃ³n result = {'valid': True, 'error': None, 'suggestions': []}\nğŸ”§ DEBUG: Antes de generar SQL...\nğŸ”§ DEBUG: hasattr list_all_pattern = False\nğŸ”§ GENERATING OPTIMIZED SQL (Enhanced with LIST ALL support):\nğŸ“Š DETECTED: English show rows â†’ using specialized generator\nğŸ“Š GENERATING SHOW ROWS SQL:\n   ğŸ“Š Show type: list\n   ğŸ“ Position: first\n   ğŸ”¢ Count: 10\n   ğŸ“‹ Object: rows\n   ğŸ”„ Using ascending order for 'first' rows\n   ğŸ¯ Show rows SQL: SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;\nğŸ”§ DEBUG: SQL conceptual generado = 'SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;'\nğŸ”— NORMALIZANDO SQL (Enhanced - Robust):\n   ğŸ“¥ Input: SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;\n      ğŸ” Searching for 'ROWID' in anchors...\n      ğŸ“ Checking dimension_anchors (type: <class 'dict'>)\n         ğŸ” Checking anchor_key: 'employee' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'category' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'brand' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'line' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'city' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'country' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'state' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'Store' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'Account' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'Item' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'Stock_Out' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'Product_Group' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'item_group' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'partner_code' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'customer_code' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'vendor_code' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'location' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'Dead_Inventory' (data type: <class 'list'>)\n         ğŸ” Checking anchor_key: 'Channel' (data type: <class 'list'>)\n      ğŸ“Š Checking metric_anchors (type: <class 'dict'>)\n         ğŸ” Checking metric anchor_key: 'Sell_Out' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'Stock_Out' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'sell_through' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'sales_amount' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'order_number' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'profit' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'margin' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'quantity' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'Inventory' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'price' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'cost' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'orders' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'transactions' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'Avg_8w' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'Avg_4w' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'Week' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'roi' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'discount' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'revenue' (data type: <class 'list'>)\n         ğŸ” Checking metric anchor_key: 'Venta_perdida' (data type: <class 'list'>)\n      âŒ No mapping found for 'ROWID'\n      ğŸ” DEBUG - Sample dimension_anchors structure:\n         'employee': <class 'list'> = ['vendedor', 'vendedores', 'empleado', 'empleados', 'personal', 'staff', 'agente', 'agentes', 'representante', 'representantes', 'ejecutivo', 'ejecutivos', 'asesor', 'asesores', 'colaborador', 'colaboradores', 'trabajador', 'trabajadores', 'operador', 'operadores', 'consultor', 'consultores', 'employee', 'employees', 'worker', 'workers', 'staff', 'personnel', 'agent', 'agents', 'representative', 'representatives', 'executive', 'executives', 'advisor', 'advisors', 'consultant', 'consultants', 'operator', 'operators', 'associate', 'associates', 'team_member', 'team_members', 'crew', 'workforce', 'human_resource', 'human_resources']\n         'category': <class 'list'> = ['categoria', 'categorias', 'categorÃ­a', 'categorÃ­as', 'cat', 'cats', 'clasificacion', 'clasificaciones', 'clasificaciÃ³n', 'segmento', 'segmentos', 'division', 'divisiones', 'divisiÃ³n', 'category', 'categories', 'classification', 'classifications', 'segment', 'segments', 'division', 'divisions', 'group', 'groups', 'type', 'types', 'kind', 'kinds', 'class', 'classes', 'section', 'sections', 'grouping', 'groupings']\n         'brand': <class 'list'> = ['marca', 'marcas', 'brand', 'brands', 'etiqueta', 'etiquetas', 'label', 'labels', 'fabricante', 'fabricantes', 'proveedor_marca', 'casa', 'casas', 'firma', 'firmas', 'nombre_comercial', 'manufacturer', 'manufacturers', 'maker', 'makers', 'producer', 'producers', 'supplier', 'suppliers', 'vendor', 'vendors', 'company', 'companies', 'trademark', 'trademarks', 'brandname', 'brandnames', 'marque', 'logo']\nğŸ”§ AGREGANDO COMILLAS (Dynamic - Using Anchors):\n   ğŸ“¥ Input: SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;\n   ğŸ“Š Normalized columns from anchors: ['Account', 'Avg_4W', 'Avg_8W', 'Brand', 'Category', 'Channel', 'City', 'Cost', 'Country', 'Customer_Code', 'Dead_Inventory', 'Discount', 'Employee', 'Inventory', 'Item', 'Item_Group', 'Line', 'Location', 'Margin', 'Order_Number', 'Orders', 'Partner_Code', 'Price', 'Product_Group', 'Profit', 'Quantity', 'Revenue', 'Roi', 'Sales_Amount', 'Sell_Out', 'Sell_Through', 'State', 'Stock_Out', 'Store', 'Transactions', 'Vendor_Code', 'Venta_Perdida', 'Week']\n   ğŸ“¤ Output: SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;\n   ğŸ“Š Reemplazos realizados: 0\n   ğŸ“¤ Output: SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;\n   ğŸ“Š Reemplazos realizados: 0\nâœ… Schema mapping applied successfully\nğŸ”§ DEBUG: SQL final = 'SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;'\nğŸ”§ DEBUG: Creating final result...\nğŸ”§ DEBUG: query_structure type: <class 'problemizador_18.QueryStructure'>\nğŸ”§ DEBUG: Has get_complexity_level: True\nğŸ”§ DEBUG: Final result created successfully\nğŸ”§ DEBUG: SQL in result = 'SELECT * FROM datos ORDER BY ROWID ASC LIMIT 10;'",
      "stderr_content": "",
      "has_content": true
    }
  },
  {
    "timestamp": "2025-12-13T22:55:12.797860",
    "component": "clickhouse",
    "level": "exception_details",
    "error_details": {
      "exception_type": "DatabaseError",
      "exception_message": "Received ClickHouse exception, code: 47, server response: Code: 47. DB::Exception: Unknown expression identifier `ROWID` in scope SELECT * FROM datos_output_data_2_20251213_223946_60ca46 ORDER BY ROWID ASC LIMIT 10. (UNKNOWN_IDENTIFIER) (version 25.11.2.24 (official build)) (for url http://localhost:8123)",
      "context": "Error ejecutando query ClickHouse",
      "traceback": "Traceback (most recent call last):\n  File \"/Users/apple/Desktop/UVM/parcial_8/BB/soluciones_prog_mov/A8_AMI/proyecto_CABI/cabi_0.0.5/interfaz/../ejecutor.py\", line 1782, in _execute_sql_on_clickhouse\n    result = self.clickhouse_manager.client.query(final_query)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/clickhouse_connect/driver/client.py\", line 238, in query\n    return self._query_with_context(query_context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/clickhouse_connect/driver/httpclient.py\", line 286, in _query_with_context\n    response = self._raw_request(body,\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/clickhouse_connect/driver/httpclient.py\", line 546, in _raw_request\n    self._error_handler(response)\n  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/clickhouse_connect/driver/httpclient.py\", line 467, in _error_handler\n    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None\nclickhouse_connect.driver.exceptions.DatabaseError: Received ClickHouse exception, code: 47, server response: Code: 47. DB::Exception: Unknown expression identifier `ROWID` in scope SELECT * FROM datos_output_data_2_20251213_223946_60ca46 ORDER BY ROWID ASC LIMIT 10. (UNKNOWN_IDENTIFIER) (version 25.11.2.24 (official build)) (for url http://localhost:8123)\n"
    }
  }
]